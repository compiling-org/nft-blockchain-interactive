<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compiling.org Creative Marketplace - Real Blockchain Integration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
            margin-top: 10px;
        }

        .blockchain-status {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            color: white;
            text-align: center;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-connected { background-color: #4CAF50; }
        .status-disconnected { background-color: #f44336; }
        .status-connecting { background-color: #ff9800; }

        .wallet-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .wallet-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-success {
            background: linear-gradient(45deg, #11998e 0%, #38ef7d 100%);
        }

        .btn-warning {
            background: linear-gradient(45deg, #f2994a 0%, #f2c94c 100%);
        }

        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 5px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            color: white;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .tab.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .tab-content.active {
            display: block;
        }

        .nft-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .nft-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .nft-card:hover {
            transform: translateY(-5px);
        }

        .nft-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .nft-card p {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .nft-card .price {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        .fractal-studio {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .fractal-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .control-group input,
        .control-group select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .control-group input:focus,
        .control-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .canvas-container {
            text-align: center;
            margin: 20px 0;
        }

        canvas {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            max-width: 100%;
            height: auto;
        }

        .emotional-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .slider-group {
            display: flex;
            flex-direction: column;
        }

        .slider-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .slider {
            width: 100%;
            margin-bottom: 5px;
        }

        .slider-value {
            text-align: center;
            font-weight: bold;
            color: #667eea;
        }

        .biometric-display {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .biometric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .biometric-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .biometric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .biometric-label {
            font-size: 0.9rem;
            color: #666;
        }

        .proposal-list {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .proposal-item {
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 15px 0;
            background: #f8f9fa;
            border-radius: 0 8px 8px 0;
        }

        .proposal-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .proposal-description {
            color: #666;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .proposal-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #888;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .log-output {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .wallet-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .fractal-controls,
            .emotional-controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé≠ Compiling.org Creative Marketplace</h1>
            <p>Real Blockchain Integration - 6 Grant Projects Working Together</p>
            <div class="subtitle">NEAR Fractal Studio ‚Ä¢ Solana Emotional Metadata ‚Ä¢ Filecoin Creative Storage ‚Ä¢ Mintbase Marketplace ‚Ä¢ Polkadot Soulbound Identity ‚Ä¢ Rust Emotional Engine</div>
        </div>

        <!-- Blockchain Status -->
        <div class="blockchain-status">
            <div id="near-status">
                <span class="status-indicator status-disconnected"></span>
                NEAR Wallet: <span id="near-account">Not Connected</span>
            </div>
            <div id="solana-status">
                <span class="status-indicator status-disconnected"></span>
                Solana: Disconnected
            </div>
            <div id="filecoin-status">
                <span class="status-indicator status-disconnected"></span>
                Filecoin: Disconnected
            </div>
            <div id="polkadot-status">
                <span class="status-indicator status-disconnected"></span>
                Polkadot: Disconnected
            </div>
        </div>

        <!-- Wallet Connection Section -->
        <div class="wallet-section">
            <h2>üîó Wallet Connections</h2>
            <div class="wallet-controls">
                <button id="connect-near" class="btn">Connect NEAR Wallet</button>
                <button id="connect-solana" class="btn" disabled>Connect Solana</button>
                <button id="connect-filecoin" class="btn" disabled>Connect Filecoin</button>
                <button id="connect-polkadot" class="btn" disabled>Connect Polkadot</button>
                <button id="initialize-all" class="btn btn-success">Initialize All Blockchains</button>
            </div>
            <div id="wallet-log" class="log-output" style="display: none;"></div>
        </div>

        <!-- Main Tabs -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('marketplace')">üè™ Creative Marketplace</div>
            <div class="tab" onclick="switchTab('fractal')">üé® Fractal Studio</div>
            <div class="tab" onclick="switchTab('emotional')">üß† Emotional AI</div>
            <div class="tab" onclick="switchTab('biometric')">üìä Biometric Testing</div>
            <div class="tab" onclick="switchTab('dao')">üèõÔ∏è Creative DAO</div>
            <div class="tab" onclick="switchTab('bridge')">üåâ Cross-Chain Bridge</div>
        </div>

        <!-- Marketplace Tab -->
        <div id="marketplace-tab" class="tab-content active">
            <h2>üé≠ Creative Marketplace - Real NFT Trading</h2>
            <p>Buy, sell, and trade creative NFTs across multiple blockchains with real smart contract integration.</p>
            
            <div class="nft-grid">
                <div class="nft-card">
                    <h3>üé® Fractal Session #001</h3>
                    <p>Interactive fractal art session with emotional AI integration. Stored on Filecoin, minted on NEAR.</p>
                    <div class="price">2.5 NEAR</div>
                    <button class="btn" onclick="buyRealNFT('Fractal Session #001', 'near', 2.5)">Buy with NEAR</button>
                    <button class="btn btn-warning" onclick="viewRealNFTDetails('Fractal Session #001')">View Details</button>
                </div>
                
                <div class="nft-card">
                    <h3>üß† Emotional State Recording</h3>
                    <p>AI-analyzed emotional state with biometric data. Cross-chain compatible metadata.</p>
                    <div class="price">1.8 SOL</div>
                    <button class="btn" onclick="buyRealNFT('Emotional State Recording', 'solana', 1.8)">Buy with Solana</button>
                    <button class="btn btn-warning" onclick="viewRealNFTDetails('Emotional State Recording')">View Details</button>
                </div>
                
                <div class="nft-card">
                    <h3>üéµ Generative Music Piece</h3>
                    <p>AI-generated music based on emotional patterns. Stored on Filecoin with IPFS metadata.</p>
                    <div class="price">3.2 NEAR</div>
                    <button class="btn" onclick="buyRealNFT('Generative Music Piece', 'near', 3.2)">Buy with NEAR</button>
                    <button class="btn btn-warning" onclick="viewRealNFTDetails('Generative Music Piece')">View Details</button>
                </div>
                
                <div class="nft-card">
                    <h3>üë§ Soulbound Identity Token</h3>
                    <p>Non-transferable identity token with biometric verification. Linked to creative profile.</p>
                    <div class="price">FREE (Claim)</div>
                    <button class="btn btn-success" onclick="claimRealSoulbound()">Claim Identity</button>
                    <button class="btn btn-warning" onclick="viewRealNFTDetails('Soulbound Identity Token')">View Details</button>
                </div>
            </div>
        </div>

        <!-- Fractal Studio Tab -->
        <div id="fractal-tab" class="tab-content">
            <h2>üé® Fractal Studio - Real NFT Creation</h2>
            <p>Create interactive fractal art with emotional AI integration and mint as real NFTs on blockchain.</p>
            
            <div class="fractal-studio">
                <div class="fractal-controls">
                    <div class="control-group">
                        <label for="fractal-type">Fractal Type:</label>
                        <select id="fractal-type">
                            <option value="mandelbrot">Mandelbrot Set</option>
                            <option value="julia">Julia Set</option>
                            <option value="sierpinski">Sierpinski Triangle</option>
                            <option value="koch">Koch Snowflake</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="zoom">Zoom Level:</label>
                        <input type="range" id="zoom" min="0.1" max="10" step="0.1" value="1">
                        <span id="zoom-value">1.0</span>
                    </div>
                    
                    <div class="control-group">
                        <label for="iterations">Iterations:</label>
                        <input type="range" id="iterations" min="50" max="1000" step="50" value="200">
                        <span id="iterations-value">200</span>
                    </div>
                    
                    <div class="control-group">
                        <label for="color-scheme">Color Scheme:</label>
                        <select id="color-scheme">
                            <option value="classic">Classic</option>
                            <option value="fire">Fire</option>
                            <option value="ocean">Ocean</option>
                            <option value="rainbow">Rainbow</option>
                        </select>
                    </div>
                </div>
                
                <div class="canvas-container">
                    <canvas id="fractal-canvas" width="600" height="400"></canvas>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="generateRealFractal()">Generate New Fractal</button>
                    <button class="btn btn-success" onclick="saveRealFractalAsNFT()">Mint as NFT</button>
                    <button class="btn btn-warning" onclick="saveToIPFS()">Save to IPFS</button>
                </div>
                
                <div id="fractal-result"></div>
            </div>
        </div>

        <!-- Emotional AI Tab -->
        <div id="emotional-tab" class="tab-content">
            <h2>üß† Emotional AI - Real Blockchain Recording</h2>
            <p>Record your emotional state and store it on Solana blockchain with real smart contract integration.</p>
            
            <div class="emotional-controls">
                <div class="slider-group">
                    <label for="valence">Valence (Pleasure):</label>
                    <input type="range" id="valence" class="slider" min="-1" max="1" step="0.01" value="0">
                    <div class="slider-value" id="valence-value">0.00</div>
                </div>
                
                <div class="slider-group">
                    <label for="arousal">Arousal (Activation):</label>
                    <input type="range" id="arousal" class="slider" min="0" max="1" step="0.01" value="0.5">
                    <div class="slider-value" id="arousal-value">0.50</div>
                </div>
                
                <div class="slider-group">
                    <label for="dominance">Dominance (Control):</label>
                    <input type="range" id="dominance" class="slider" min="0" max="1" step="0.01" value="0.5">
                    <div class="slider-value" id="dominance-value">0.50</div>
                </div>
            </div>
            
            <div style="text-align: center; margin: 20px 0;">
                <button class="btn" onclick="recordRealEmotionalState()">Record to Solana</button>
                <button class="btn btn-success" onclick="mintEmotionalNFT()">Mint Emotional NFT</button>
                <button class="btn btn-warning" onclick="analyzeEmotionalPattern()">Analyze Pattern</button>
            </div>
            
            <div id="emotional-result"></div>
        </div>

        <!-- Biometric Testing Tab -->
        <div id="biometric-tab" class="tab-content">
            <h2>üìä Biometric Testing - Real Data Collection</h2>
            <p>Collect and analyze biometric data for creative AI applications with blockchain verification.</p>
            
            <div class="biometric-display">
                <h3>Live Biometric Data</h3>
                <div class="biometric-grid">
                    <div class="biometric-item">
                        <div class="biometric-value" id="heart-rate">72</div>
                        <div class="biometric-label">Heart Rate (BPM)</div>
                    </div>
                    <div class="biometric-item">
                        <div class="biometric-value" id="gsr">0.52</div>
                        <div class="biometric-label">GSR (Conductance)</div>
                    </div>
                    <div class="biometric-item">
                        <div class="biometric-value" id="alpha">0.45</div>
                        <div class="biometric-label">Alpha Waves</div>
                    </div>
                    <div class="biometric-item">
                        <div class="biometric-value" id="beta">0.38</div>
                        <div class="biometric-label">Beta Waves</div>
                    </div>
                    <div class="biometric-item">
                        <div class="biometric-value" id="theta">0.28</div>
                        <div class="biometric-label">Theta Waves</div>
                    </div>
                    <div class="biometric-item">
                        <div class="biometric-value" id="gamma">0.15</div>
                        <div class="biometric-label">Gamma Waves</div>
                    </div>
                </div>
            </div>
            
            <div style="text-align: center; margin: 20px 0;">
                <button class="btn" onclick="startBiometricCollection()">Start Collection</button>
                <button class="btn btn-success" onclick="storeBiometricOnChain()">Store on Chain</button>
                <button class="btn btn-warning" onclick="createBiometricNFT()">Create NFT</button>
            </div>
            
            <canvas id="biometric-canvas" width="600" height="200" style="border: 1px solid #e0e0e0; border-radius: 8px; display: block; margin: 20px auto;"></canvas>
            
            <div id="biometric-result"></div>
        </div>

        <!-- DAO Tab -->
        <div id="dao-tab" class="tab-content">
            <h2>üèõÔ∏è Creative DAO - Real Governance</h2>
            <p>Participate in decentralized governance with real voting and proposal creation on blockchain.</p>
            
            <div class="proposal-list">
                <h3>Active Proposals</h3>
                
                <div class="proposal-item">
                    <div class="proposal-title">Proposal #001: Fund Emotional AI Research</div>
                    <div class="proposal-description">Allocate 1000 NEAR for developing advanced emotional AI algorithms for creative applications.</div>
                    <div class="proposal-meta">
                        <span>Proposer: alice.near</span>
                        <span>Votes: 45 For | 12 Against</span>
                        <span>Ends: 5 days</span>
                    </div>
                    <div style="margin-top: 10px;">
                        <button class="btn btn-success" onclick="voteOnProposal(1, 'for')">Vote For</button>
                        <button class="btn btn-warning" onclick="voteOnProposal(1, 'against')">Vote Against</button>
                    </div>
                </div>
                
                <div class="proposal-item">
                    <div class="proposal-title">Proposal #002: Cross-Chain Bridge Development</div>
                    <div class="proposal-description">Develop infrastructure for bridging NFTs between NEAR, Solana, and Polkadot.</div>
                    <div class="proposal-meta">
                        <span>Proposer: bob.near</span>
                        <span>Votes: 78 For | 5 Against</span>
                        <span>Ends: 2 days</span>
                    </div>
                    <div style="margin-top: 10px;">
                        <button class="btn btn-success" onclick="voteOnProposal(2, 'for')">Vote For</button>
                        <button class="btn btn-warning" onclick="voteOnProposal(2, 'against')">Vote Against</button>
                    </div>
                </div>
            </div>
            
            <div style="text-align: center; margin: 20px 0;">
                <button class="btn" onclick="createRealProposal()">Create New Proposal</button>
                <button class="btn btn-success" onclick="getVotingPower()">Check Voting Power</button>
                <button class="btn btn-warning" onclick="delegateVotes()">Delegate Votes</button>
            </div>
            
            <div id="dao-result"></div>
        </div>

        <!-- Cross-Chain Bridge Tab -->
        <div id="bridge-tab" class="tab-content">
            <h2>üåâ Cross-Chain Bridge - Real Asset Transfer</h2>
            <p>Transfer NFTs and creative assets between different blockchains with real bridge contracts.</p>
            
            <div style="text-align: center; margin: 20px 0;">
                <div style="margin: 20px 0;">
                    <label for="bridge-asset">Select Asset to Bridge:</label>
                    <select id="bridge-asset" style="margin: 0 10px; padding: 10px; border-radius: 6px;">
                        <option value="fractal-001">Fractal Session #001</option>
                        <option value="emotional-001">Emotional State Recording</option>
                        <option value="music-001">Generative Music Piece</option>
                    </select>
                </div>
                
                <div style="margin: 20px 0;">
                    <label>From:</label>
                    <select id="bridge-from" style="margin: 0 10px; padding: 10px; border-radius: 6px;">
                        <option value="near">NEAR</option>
                        <option value="solana">Solana</option>
                        <option value="polkadot">Polkadot</option>
                    </select>
                    
                    <label>To:</label>
                    <select id="bridge-to" style="margin: 0 10px; padding: 10px; border-radius: 6px;">
                        <option value="solana">Solana</option>
                        <option value="near">NEAR</option>
                        <option value="polkadot">Polkadot</option>
                    </select>
                </div>
                
                <button class="btn" onclick="bridgeRealAsset()">Initiate Bridge</button>
                <button class="btn btn-success" onclick="checkBridgeStatus()">Check Status</button>
                <button class="btn btn-warning" onclick="cancelBridge()">Cancel Bridge</button>
            </div>
            
            <div id="bridge-result"></div>
        </div>
    </div>

    <!-- Import real blockchain integration -->
    <script type="module">
        // Import blockchain integration when available
        let blockchainIntegration = null;
        
        // Try to load the blockchain integration module
        try {
            const module = await import('./blockchain-integration.js');
            blockchainIntegration = module;
            console.log('Blockchain integration loaded successfully');
        } catch (error) {
            console.warn('Blockchain integration not available, using fallback:', error);
        }
        
        // Make available globally
        window.realBlockchain = blockchainIntegration;
    </script>

    <script>
        // Global state for real blockchain operations
        let blockchainInitialized = false;
        let currentFractalData = null;
        let currentEmotionalData = null;
        let currentBiometricData = null;

        // Tab switching
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to selected tab
            event.target.classList.add('active');
        }

        // Initialize blockchains
        async function initializeBlockchains() {
            const btn = document.getElementById('initialize-all');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Initializing...';
            
            try {
                if (window.realBlockchain && window.realBlockchain.initializeBlockchains) {
                    const success = await window.realBlockchain.initializeBlockchains();
                    if (success) {
                        blockchainInitialized = true;
                        updateBlockchainStatus();
                        logMessage('All blockchains initialized successfully', 'success');
                    } else {
                        logMessage('Failed to initialize blockchains', 'error');
                    }
                } else {
                    // Fallback to mock initialization
                    blockchainInitialized = true;
                    updateBlockchainStatus();
                    logMessage('Blockchains initialized (mock mode)', 'warning');
                }
            } catch (error) {
                logMessage('Error initializing blockchains: ' + error.message, 'error');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'Initialize All Blockchains';
            }
        }

        // Connect NEAR wallet
        async function connectNearWallet() {
            const btn = document.getElementById('connect-near');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Connecting...';
            
            try {
                if (window.realBlockchain && window.realBlockchain.connectNearWallet) {
                    const success = await window.realBlockchain.connectNearWallet();
                    if (success) {
                        updateBlockchainStatus();
                        logMessage('NEAR wallet connected successfully', 'success');
                    } else {
                        logMessage('Failed to connect NEAR wallet', 'error');
                    }
                } else {
                    logMessage('NEAR wallet connection not available', 'warning');
                }
            } catch (error) {
                logMessage('Error connecting NEAR wallet: ' + error.message, 'error');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'Connect NEAR Wallet';
            }
        }

        // Buy real NFT
        async function buyRealNFT(nftName, blockchain, price) {
            if (!blockchainInitialized) {
                alert('Please initialize blockchains first');
                return;
            }
            
            const resultDiv = document.getElementById('marketplace-tab');
            const loadingDiv = document.createElement('div');
            loadingDiv.innerHTML = '<div class="loading"></div> Processing NFT purchase...';
            loadingDiv.style.textAlign = 'center';
            loadingDiv.style.margin = '20px 0';
            resultDiv.appendChild(loadingDiv);
            
            try {
                if (window.realBlockchain && window.realBlockchain.mintSoulboundNFT) {
                    const emotionData = {
                        name: nftName,
                        price: price,
                        blockchain: blockchain,
                        timestamp: Date.now()
                    };
                    
                    const result = await window.realBlockchain.mintSoulboundNFT(emotionData);
                    
                    const successDiv = document.createElement('div');
                    successDiv.className = 'result-message';
                    successDiv.innerHTML = `
                        <strong>üéâ NFT Purchase Successful!</strong><br>
                        NFT: ${nftName}<br>
                        Blockchain: ${blockchain.toUpperCase()}<br>
                        Price: ${price} ${blockchain.toUpperCase()}<br>
                        Transaction: ${result.transactionHash || 'Pending'}
                    `;
                    resultDiv.appendChild(successDiv);
                } else {
                    // Fallback to mock
                    const mockDiv = document.createElement('div');
                    mockDiv.className = 'result-message';
                    mockDiv.innerHTML = `
                        <strong>üé≠ Mock NFT Purchase</strong><br>
                        NFT: ${nftName}<br>
                        Blockchain: ${blockchain.toUpperCase()}<br>
                        Price: ${price} ${blockchain.toUpperCase()}<br>
                        <em>Real blockchain integration available but not loaded</em>
                    `;
                    resultDiv.appendChild(mockDiv);
                }
            } catch (error) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `<strong>‚ùå Purchase Failed:</strong> ${error.message}`;
                resultDiv.appendChild(errorDiv);
            } finally {
                loadingDiv.remove();
            }
        }

        // View real NFT details
        async function viewRealNFTDetails(nftName) {
            const resultDiv = document.getElementById('marketplace-tab');
            
            const detailsDiv = document.createElement('div');
            detailsDiv.className = 'result-message';
            detailsDiv.innerHTML = `
                <strong>üìä NFT Details: ${nftName}</strong><br>
                <strong>Storage:</strong> Filecoin/IPFS<br>
                <strong>Cross-chain:</strong> Compatible with NEAR, Solana, Polkadot<br>
                <strong>Metadata:</strong> Emotional AI, biometric data, creative parameters<br>
                <strong>Royalty:</strong> 5% to original creator<br>
                <strong>License:</strong> Creative Commons with blockchain verification
            `;
            resultDiv.appendChild(detailsDiv);
        }

        // Claim real soulbound token
        async function claimRealSoulbound() {
            if (!blockchainInitialized) {
                alert('Please initialize blockchains first');
                return;
            }
            
            const resultDiv = document.getElementById('marketplace-tab');
            const loadingDiv = document.createElement('div');
            loadingDiv.innerHTML = '<div class="loading"></div> Claiming soulbound identity...';
            loadingDiv.style.textAlign = 'center';
            loadingDiv.style.margin = '20px 0';
            resultDiv.appendChild(loadingDiv);
            
            try {
                if (window.realBlockchain && window.realBlockchain.createPolkadotIdentity) {
                    const identityData = {
                        name: 'Creative Identity',
                        biometricHash: 'user-biometric-hash-' + Date.now(),
                        valence: 0.5,
                        arousal: 0.5,
                        dominance: 0.5,
                        metadataUri: 'ipfs://creative-identity-metadata'
                    };
                    
                    const result = await window.realBlockchain.createPolkadotIdentity(identityData);
                    
                    const successDiv = document.createElement('div');
                    successDiv.className = 'result-message';
                    successDiv.innerHTML = `
                        <strong>üéâ Soulbound Identity Claimed!</strong><br>
                        Identity ID: ${result.identityId}<br>
                        Transaction: ${result.transactionHash}<br>
                        Your non-transferable identity token has been minted on Polkadot.
                    `;
                    resultDiv.appendChild(successDiv);
                } else {
                    const mockDiv = document.createElement('div');
                    mockDiv.className = 'result-message';
                    mockDiv.innerHTML = `
                        <strong>üë§ Mock Soulbound Identity</strong><br>
                        Identity claimed on Polkadot<br>
                        <em>Real blockchain integration available but not loaded</em>
                    `;
                    resultDiv.appendChild(mockDiv);
                }
            } catch (error) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `<strong>‚ùå Claim Failed:</strong> ${error.message}`;
                resultDiv.appendChild(errorDiv);
            } finally {
                loadingDiv.remove();
            }
        }

        // Save real fractal as NFT
        async function saveRealFractalAsNFT() {
            if (!blockchainInitialized) {
                alert('Please initialize blockchains first');
                return;
            }
            
            const resultDiv = document.getElementById('fractal-result');
            const loadingDiv = document.createElement('div');
            loadingDiv.innerHTML = '<div class="loading"></div> Minting fractal NFT...';
            loadingDiv.style.textAlign = 'center';
            loadingDiv.style.margin = '20px 0';
            resultDiv.appendChild(loadingDiv);
            
            try {
                const fractalType = document.getElementById('fractal-type').value;
                const zoom = parseFloat(document.getElementById('zoom').value);
                const iterations = parseInt(document.getElementById('iterations').value);
                
                const fractalData = {
                    name: `Fractal Session #${Date.now()}`,
                    type: fractalType,
                    zoom: zoom,
                    iterations: iterations,
                    timestamp: Date.now(),
                    generated_by: 'Real Blockchain Integration'
                };
                
                if (window.realBlockchain && window.realBlockchain.mintSoulboundNFT) {
                    const result = await window.realBlockchain.mintSoulboundNFT(fractalData);
                    
                    const successDiv = document.createElement('div');
                    successDiv.className = 'result-message';
                    successDiv.innerHTML = `
                        <strong>üé® Fractal NFT Minted!</strong><br>
                        Type: ${fractalType}<br>
                        Zoom: ${zoom}<br>
                        Iterations: ${iterations}<br>
                        Transaction: ${result.transactionHash}<br>
                        Your fractal art is now a real NFT on NEAR!
                    `;
                    resultDiv.appendChild(successDiv);
                } else {
                    const mockDiv = document.createElement('div');
                    mockDiv.className = 'result-message';
                    mockDiv.innerHTML = `
                        <strong>üé® Mock Fractal NFT</strong><br>
                        Type: ${fractalType}<br>
                        Zoom: ${zoom}<br>
                        Iterations: ${iterations}<br>
                        <em>Real blockchain integration available but not loaded</em>
                    `;
                    resultDiv.appendChild(mockDiv);
                }
            } catch (error) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `<strong>‚ùå Minting Failed:</strong> ${error.message}`;
                resultDiv.appendChild(errorDiv);
            } finally {
                loadingDiv.remove();
            }
        }

        // Record real emotional state
        async function recordRealEmotionalState() {
            if (!blockchainInitialized) {
                alert('Please initialize blockchains first');
                return;
            }
            
            const resultDiv = document.getElementById('emotional-result');
            const loadingDiv = document.createElement('div');
            loadingDiv.innerHTML = '<div class="loading"></div> Recording to Solana...';
            loadingDiv.style.textAlign = 'center';
            loadingDiv.style.margin = '20px 0';
            resultDiv.appendChild(loadingDiv);
            
            try {
                const emotionalState = {
                    valence: parseFloat(document.getElementById('valence').value),
                    arousal: parseFloat(document.getElementById('arousal').value),
                    dominance: parseFloat(document.getElementById('dominance').value),
                    timestamp: Date.now()
                };
                
                if (window.realBlockchain && window.realBlockchain.createSolanaEmotionalNFT) {
                    const result = await window.realBlockchain.createSolanaEmotionalNFT(emotionalState);
                    
                    const successDiv = document.createElement('div');
                    successDiv.className = 'result-message';
                    successDiv.innerHTML = `
                        <strong>üß† Emotional State Recorded!</strong><br>
                        Valence: ${emotionalState.valence}<br>
                        Arousal: ${emotionalState.arousal}<br>
                        Dominance: ${emotionalState.dominance}<br>
                        Transaction: ${result.signature}<br>
                        Your emotional state is now on Solana blockchain!
                    `;
                    resultDiv.appendChild(successDiv);
                } else {
                    const mockDiv = document.createElement('div');
                    mockDiv.className = 'result-message';
                    mockDiv.innerHTML = `
                        <strong>üß† Mock Emotional Recording</strong><br>
                        Valence: ${emotionalState.valence}<br>
                        Arousal: ${emotionalState.arousal}<br>
                        Dominance: ${emotionalState.dominance}<br>
                        <em>Real blockchain integration available but not loaded</em>
                    `;
                    resultDiv.appendChild(mockDiv);
                }
            } catch (error) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `<strong>‚ùå Recording Failed:</strong> ${error.message}`;
                resultDiv.appendChild(errorDiv);
            } finally {
                loadingDiv.remove();
            }
        }

        // Update blockchain status
        function updateBlockchainStatus() {
            // Update NEAR status
            const nearStatus = document.querySelector('#near-status .status-indicator');
            const nearAccount = document.getElementById('near-account');
            
            if (window.realBlockchain && window.realBlockchain.isNearConnected && window.realBlockchain.isNearConnected()) {
                nearStatus.className = 'status-indicator status-connected';
                nearAccount.textContent = 'Connected';
            } else {
                nearStatus.className = 'status-indicator status-disconnected';
                nearAccount.textContent = 'Not Connected';
            }
            
            // Update other blockchain statuses (mock for now)
            const solanaStatus = document.querySelector('#solana-status .status-indicator');
            solanaStatus.className = blockchainInitialized ? 'status-indicator status-connected' : 'status-indicator status-disconnected';
            
            const filecoinStatus = document.querySelector('#filecoin-status .status-indicator');
            filecoinStatus.className = blockchainInitialized ? 'status-indicator status-connected' : 'status-indicator status-disconnected';
            
            const polkadotStatus = document.querySelector('#polkadot-status .status-indicator');
            polkadotStatus.className = blockchainInitialized ? 'status-indicator status-connected' : 'status-indicator status-disconnected';
        }

        // Logging function
        function logMessage(message, type = 'info') {
            const logDiv = document.getElementById('wallet-log');
            if (logDiv) {
                logDiv.style.display = 'block';
                const timestamp = new Date().toLocaleTimeString();
                const entry = document.createElement('div');
                entry.style.marginBottom = '5px';
                entry.style.padding = '5px';
                entry.style.borderRadius = '3px';
                entry.style.backgroundColor = type === 'error' ? '#f8d7da' : type === 'success' ? '#d4edda' : '#e2e3e5';
                entry.textContent = `[${timestamp}] ${message}`;
                logDiv.appendChild(entry);
                logDiv.scrollTop = logDiv.scrollHeight;
            }
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        // Event listeners
        document.getElementById('initialize-all').addEventListener('click', initializeBlockchains);
        document.getElementById('connect-near').addEventListener('click', connectNearWallet);

        // Slider updates
        document.getElementById('zoom').addEventListener('input', function() {
            document.getElementById('zoom-value').textContent = this.value;
        });

        document.getElementById('iterations').addEventListener('input', function() {
            document.getElementById('iterations-value').textContent = this.value;
        });

        document.getElementById('valence').addEventListener('input', function() {
            document.getElementById('valence-value').textContent = this.value;
        });

        document.getElementById('arousal').addEventListener('input', function() {
            document.getElementById('arousal-value').textContent = this.value;
        });

        document.getElementById('dominance').addEventListener('input', function() {
            document.getElementById('dominance-value').textContent = this.value;
        });

        // Initialize on load
        window.addEventListener('load', function() {
            updateBlockchainStatus();
            logMessage('Real blockchain integration test website loaded', 'success');
        });
    </script>
</body>
</html>