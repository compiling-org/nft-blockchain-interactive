<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compiling.org Creative Marketplace - Test Environment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
            margin-top: 10px;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .tab:hover, .tab.active {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .marketplace-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .nft-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .nft-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        .nft-image {
            width: 100%;
            height: 220px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            background-size: 400% 400%;
            animation: gradientShift 4s ease infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .nft-info {
            padding: 20px;
        }

        .nft-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .nft-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .nft-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px 0;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
        }

        .nft-price {
            font-size: 1.3rem;
            font-weight: bold;
            color: #667eea;
        }

        .nft-chain {
            background: #f0f0f0;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            color: #666;
        }

        .nft-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            flex: 1;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #666;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .btn-success {
            background: linear-gradient(45deg, #56ab2f, #a8e063);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(86, 171, 47, 0.4);
        }

        .create-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-bottom: 40px;
        }

        .create-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .create-section p {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .test-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .test-notice strong {
            color: #856404;
        }

        .dao-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-bottom: 40px;
        }

        .dao-section h2 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .proposals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .proposal-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #667eea;
        }

        .proposal-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .proposal-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .proposal-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 15px;
        }

        .proposal-votes {
            display: flex;
            gap: 15px;
        }

        .vote-count {
            font-weight: bold;
        }

        .vote-for {
            color: #28a745;
        }

        .vote-against {
            color: #dc3545;
        }

        .wallet-info {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }

        .blockchain-log {
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }

        .blockchain-log.visible {
            display: block;
        }

        .log-entry {
            padding: 3px 0;
            border-bottom: 1px solid rgba(0, 255, 0, 0.1);
        }

        .log-entry.log-success { color: #22c55e; }
        .log-entry.log-error { color: #ef4444; }
        .log-entry.log-info { color: #3b82f6; }
        .log-entry.log-warning { color: #fbbf24; }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .marketplace-grid {
                grid-template-columns: 1fr;
            }

            .proposals-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üß† Compiling.org Creative Marketplace</h1>
            <p>Real-time creative NFTs powered by emotional AI and decentralized storage</p>
            <div class="subtitle">Test Environment ‚Ä¢ Mintbase Integration ‚Ä¢ Interactive NFTs ‚Ä¢ Soulbound Identity ‚Ä¢ Cross-Chain Support</div>
        </header>

        <div class="wallet-info" id="wallet-status">
            üîó <button class="btn btn-primary" onclick="window.walletConnections.connectAllWallets()" style="padding: 8px 20px; margin: 0 10px;">Connect All Wallets</button>
            <button class="btn btn-secondary" onclick="window.walletConnections.showTestnetInfo()" style="padding: 8px 20px;">Testnet Info</button>
        </div>

        <div class="test-notice">
            <strong>üß™ Test Environment:</strong> This is our development marketplace for testing all grant features.
            All transactions are simulated for development and testing purposes.
            <br>
            <strong>Network Status:</strong> 
            <span id="near-status" style="color: #fbbf24;">‚ö´ NEAR</span> | 
            <span id="solana-status" style="color: #fbbf24;">‚ö´ Solana</span> | 
            <span id="ipfs-status" style="color: #fbbf24;">‚ö´ IPFS</span> | 
            <span id="wasm-status" style="color: #fbbf24;">‚ö´ WASM</span>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('marketplace')">üõí Marketplace</button>
            <button class="tab" onclick="switchTab('create')">üé® Create NFT</button>
            <button class="tab" onclick="switchTab('dao')">üèõÔ∏è DAO Governance</button>
            <button class="tab" onclick="switchTab('soulbound')">üë§ Soulbound Tokens</button>
            <button class="tab" onclick="switchTab('crosschain')">üîó Cross-Chain</button>
            <button class="tab" onclick="switchTab('fractal')">üåÄ Fractal Studio</button>
            <button class="tab" onclick="switchTab('neuroemotive')">üß† Neuroemotive AI</button>
            <button class="tab" onclick="switchTab('biometric')">üíì Biometric Test</button>
            <button class="tab" onclick="switchTab('settings')">‚öôÔ∏è Settings</button>
        </div>

        <section id="marketplace-tab" class="tab-content">
            <div class="marketplace-grid">
                <!-- Emotional Fractal NFT -->
                <div class="nft-card">
                    <div class="nft-image">üåÄ Emotional Fractal</div>
                    <div class="nft-info">
                        <div class="nft-title">Emotional Fractal #001</div>
                        <div class="nft-description">
                            A fractal generated from real-time emotional data captured during a live performance.
                            Valence: 0.7, Arousal: 0.8, Dominance: 0.6
                        </div>
                        <div class="nft-meta">
                            <div class="nft-price">0.5 NEAR</div>
                            <div class="nft-chain">NEAR</div>
                        </div>
                        <div class="nft-actions">
                            <button class="btn btn-primary" onclick="buyNFT('Emotional Fractal #001')">Buy Now</button>
                            <button class="btn btn-secondary" onclick="viewDetails('Emotional Fractal #001')">Details</button>
                        </div>
                    </div>
                </div>

                <!-- Live Shader Performance -->
                <div class="nft-card">
                    <div class="nft-image">üåà Live Shader</div>
                    <div class="nft-info">
                        <div class="nft-title">Live Shader Performance #042</div>
                        <div class="nft-description">
                            Interactive shader parameters captured during a 15-minute live coding session.
                            Seed: 0xDEADBEEF, Iterations: 2500, Complexity: High
                        </div>
                        <div class="nft-meta">
                            <div class="nft-price">1.2 SOL</div>
                            <div class="nft-chain">Solana</div>
                        </div>
                        <div class="nft-actions">
                            <button class="btn btn-primary" onclick="buyNFT('Live Shader Performance #042')">Buy Now</button>
                            <button class="btn btn-secondary" onclick="viewDetails('Live Shader Performance #042')">Details</button>
                        </div>
                    </div>
                </div>

                <!-- Audiovisual Composition -->
                <div class="nft-card">
                    <div class="nft-image">üéµ Audio Visual</div>
                    <div class="nft-info">
                        <div class="nft-title">Neuro-Sonic Landscape #089</div>
                        <div class="nft-description">
                            Audiovisual composition generated from EEG data and emotional state vectors.
                            Duration: 4:23, Channels: 8, Emotional Resonance: 0.85
                        </div>
                        <div class="nft-meta">
                            <div class="nft-price">2.1 ETH</div>
                            <div class="nft-chain">Ethereum</div>
                        </div>
                        <div class="nft-actions">
                            <button class="btn btn-primary" onclick="buyNFT('Neuro-Sonic Landscape #089')">Buy Now</button>
                            <button class="btn btn-secondary" onclick="viewDetails('Neuro-Sonic Landscape #089')">Details</button>
                        </div>
                    </div>
                </div>

                <!-- Interactive Soulbound NFT -->
                <div class="nft-card">
                    <div class="nft-image">üë§ Soulbound ID</div>
                    <div class="nft-info">
                        <div class="nft-title">Creative Identity Badge</div>
                        <div class="nft-description">
                            Soulbound NFT representing your creative identity and emotional profile.
                            Non-transferable, Mintbase-compatible, DAO governance enabled.
                        </div>
                        <div class="nft-meta">
                            <div class="nft-price">Claim Free</div>
                            <div class="nft-chain">NEAR/Mintbase</div>
                        </div>
                        <div class="nft-actions">
                            <button class="btn btn-success" onclick="claimSoulbound()">Claim Identity</button>
                            <button class="btn btn-secondary" onclick="viewDetails('Creative Identity Badge')">View Details</button>
                        </div>
                    </div>
                </div>

                <!-- Mintbase Series NFT -->
                <div class="nft-card">
                    <div class="nft-image">üé® Mintbase Series</div>
                    <div class="nft-info">
                        <div class="nft-title">Emotional Landscapes #001</div>
                        <div class="nft-description">
                            Part of a Mintbase series exploring emotional states through generative art.
                            1/1 unique piece, full commercial rights, perpetual royalties.
                        </div>
                        <div class="nft-meta">
                            <div class="nft-price">3.5 NEAR</div>
                            <div class="nft-chain">Mintbase</div>
                        </div>
                        <div class="nft-actions">
                            <button class="btn btn-primary" onclick="buyNFT('Emotional Landscapes #001')">Buy on Mintbase</button>
                            <button class="btn btn-secondary" onclick="viewDetails('Emotional Landscapes #001')">View Series</button>
                        </div>
                    </div>
                </div>

                <!-- Cross-Chain Interactive NFT -->
                <div class="nft-card">
                    <div class="nft-image">üåê Cross-Chain</div>
                    <div class="nft-info">
                        <div class="nft-title">Multi-Chain Emotion #077</div>
                        <div class="nft-description">
                            Interactive NFT that evolves across multiple blockchains.
                            Currently on NEAR, can be bridged to Solana and Ethereum.
                        </div>
                        <div class="nft-meta">
                            <div class="nft-price">5.0 NEAR</div>
                            <div class="nft-chain">Multi-Chain</div>
                        </div>
                        <div class="nft-actions">
                            <button class="btn btn-primary" onclick="buyNFT('Multi-Chain Emotion #077')">Buy Now</button>
                            <button class="btn btn-secondary" onclick="bridgeNFT('Multi-Chain Emotion #077')">Bridge</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="create-tab" class="tab-content" style="display: none;">
            <div class="create-section">
                <h2>üé® Create Your Own Creative NFT</h2>
                <p>
                    Use our NUWE creative engine to generate real-time art from your emotional state.
                    Mint unique NFTs that capture the essence of your creative moments, stored permanently
                    on IPFS and tokenized across multiple blockchains.
                </p>
                <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-primary" style="font-size: 1.1rem; padding: 15px 30px;" onclick="launchCreativeStudio()">
                        üöÄ Launch Creative Studio
                    </button>
                    <button class="btn btn-secondary" style="font-size: 1.1rem; padding: 15px 30px;" onclick="showTemplates()">
                        üìö Template Gallery
                    </button>
                </div>
            </div>
        </section>

        <section id="dao-tab" class="tab-content" style="display: none;">
            <div class="dao-section">
                <h2>üèõÔ∏è DAO Governance</h2>
                <p>Participate in platform governance and decision-making</p>
                
                <div class="proposals-grid">
                    <div class="proposal-card">
                        <div class="proposal-title">Add 2% Marketplace Fee</div>
                        <div class="proposal-description">
                            Proposal to introduce a 2% fee on all marketplace transactions to fund platform development and community initiatives.
                        </div>
                        <div class="proposal-meta">
                            <span>Proposed by: governance.testnet</span>
                            <span>Ends in: 3 days</span>
                        </div>
                        <div class="proposal-votes">
                            <span class="vote-count vote-for">üëç For: 42</span>
                            <span class="vote-count vote-against">üëé Against: 18</span>
                        </div>
                        <div style="margin-top: 15px; display: flex; gap: 10px;">
                            <button class="btn btn-success" style="flex: 1;" onclick="voteProposal(1, true)">Vote For</button>
                            <button class="btn btn-secondary" style="flex: 1;" onclick="voteProposal(1, false)">Vote Against</button>
                        </div>
                    </div>

                    <div class="proposal-card">
                        <div class="proposal-title">Add Solana Integration</div>
                        <div class="proposal-description">
                            Proposal to expand our cross-chain support to include Solana integration for high-throughput creative metadata.
                        </div>
                        <div class="proposal-meta">
                            <span>Proposed by: dev-team.testnet</span>
                            <span>Ends in: 5 days</span>
                        </div>
                        <div class="proposal-votes">
                            <span class="vote-count vote-for">üëç For: 67</span>
                            <span class="vote-count vote-against">üëé Against: 8</span>
                        </div>
                        <div style="margin-top: 15px; display: flex; gap: 10px;">
                            <button class="btn btn-success" style="flex: 1;" onclick="voteProposal(2, true)">Vote For</button>
                            <button class="btn btn-secondary" style="flex: 1;" onclick="voteProposal(2, false)">Vote Against</button>
                        </div>
                    </div>

                    <div class="proposal-card">
                        <div class="proposal-title">Increase Quorum to 60%</div>
                        <div class="proposal-description">
                            Proposal to increase the required quorum for DAO decisions from 51% to 60% to ensure broader community consensus.
                        </div>
                        <div class="proposal-meta">
                            <span>Proposed by: community.testnet</span>
                            <span>Ends in: 7 days</span>
                        </div>
                        <div class="proposal-votes">
                            <span class="vote-count vote-for">üëç For: 23</span>
                            <span class="vote-count vote-against">üëé Against: 31</span>
                        </div>
                        <div style="margin-top: 15px; display: flex; gap: 10px;">
                            <button class="btn btn-success" style="flex: 1;" onclick="voteProposal(3, true)">Vote For</button>
                            <button class="btn btn-secondary" style="flex: 1;" onclick="voteProposal(3, false)">Vote Against</button>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="createProposal()">‚ûï Create New Proposal</button>
                </div>
            </div>
        </section>

        <section id="soulbound-tab" class="tab-content" style="display: none;">
            <div class="create-section">
                <h2>üë§ Soulbound Token Management</h2>
                <p>Manage your non-transferable creative identity tokens</p>
                
                <div class="marketplace-grid">
                    <div class="nft-card">
                        <div class="nft-image">üéì Creator Badge</div>
                        <div class="nft-info">
                            <div class="nft-title">Verified Creator</div>
                            <div class="nft-description">
                                Soulbound token proving your status as a verified creator on our platform.
                                Non-transferable and permanently linked to your account.
                            </div>
                            <div class="nft-meta">
                                <div class="nft-price">Minted</div>
                                <div class="nft-chain">Soulbound</div>
                            </div>
                            <div class="nft-actions">
                                <button class="btn btn-secondary" onclick="viewSoulboundDetails('Verified Creator')">View Details</button>
                            </div>
                        </div>
                    </div>

                    <div class="nft-card">
                        <div class="nft-image">üèÜ Achievement</div>
                        <div class="nft-info">
                            <div class="nft-title">First NFT Minted</div>
                            <div class="nft-description">
                                Soulbound achievement token for minting your first creative NFT on our platform.
                                Celebrates your entry into the creative NFT ecosystem.
                            </div>
                            <div class="nft-meta">
                                <div class="nft-price">Minted</div>
                                <div class="nft-chain">Soulbound</div>
                            </div>
                            <div class="nft-actions">
                                <button class="btn btn-secondary" onclick="viewSoulboundDetails('First NFT Minted')">View Details</button>
                            </div>
                        </div>
                    </div>

                    <div class="nft-card">
                        <div class="nft-image">ü§ù Community</div>
                        <div class="nft-info">
                            <div class="nft-title">Community Contributor</div>
                            <div class="nft-description">
                                Soulbound token for active participation in our community discussions and governance.
                                Shows your commitment to platform development.
                            </div>
                            <div class="nft-meta">
                                <div class="nft-price">Minted</div>
                                <div class="nft-chain">Soulbound</div>
                            </div>
                            <div class="nft-actions">
                                <button class="btn btn-secondary" onclick="viewSoulboundDetails('Community Contributor')">View Details</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <button class="btn btn-primary" onclick="claimNewSoulbound()">üéÅ Claim New Soulbound Token</button>
                </div>
            </div>
        </section>

        <section id="crosschain-tab" class="tab-content" style="display: none;">
            <div class="create-section">
                <h2>üîó Cross-Chain Bridge</h2>
                <p>Bridge your NFTs between different blockchain networks</p>
                
                <div class="marketplace-grid">
                    <div class="nft-card">
                        <div class="nft-image">üåâ Bridge</div>
                        <div class="nft-info">
                            <div class="nft-title">NEAR to Solana Bridge</div>
                            <div class="nft-description">
                                Bridge your NEAR-based NFTs to Solana for high-throughput metadata recording.
                                Maintains all interactive features and emotional data.
                            </div>
                            <div class="nft-meta">
                                <div class="nft-price">0.01 NEAR</div>
                                <div class="nft-chain">Bridge Fee</div>
                            </div>
                            <div class="nft-actions">
                                <button class="btn btn-primary" onclick="initiateBridge('NEAR', 'Solana')">Bridge Now</button>
                            </div>
                        </div>
                    </div>

                    <div class="nft-card">
                        <div class="nft-image">üåâ Bridge</div>
                        <div class="nft-info">
                            <div class="nft-title">Solana to Ethereum Bridge</div>
                            <div class="nft-description">
                                Bridge your Solana-based NFTs to Ethereum for maximum market liquidity.
                                Supports all standard NFT marketplaces.
                            </div>
                            <div class="nft-meta">
                                <div class="nft-price">0.005 SOL</div>
                                <div class="nft-chain">Bridge Fee</div>
                            </div>
                            <div class="nft-actions">
                                <button class="btn btn-primary" onclick="initiateBridge('Solana', 'Ethereum')">Bridge Now</button>
                            </div>
                        </div>
                    </div>

                    <div class="nft-card">
                        <div class="nft-image">üåâ Bridge</div>
                        <div class="nft-info">
                            <div class="nft-title">Ethereum to NEAR Bridge</div>
                            <div class="nft-description">
                                Bridge your Ethereum-based NFTs to NEAR for interactive features and low-cost transactions.
                                Perfect for frequent interactions and updates.
                            </div>
                            <div class="nft-meta">
                                <div class="nft-price">0.001 ETH</div>
                                <div class="nft-chain">Bridge Fee</div>
                            </div>
                            <div class="nft-actions">
                                <button class="btn btn-primary" onclick="initiateBridge('Ethereum', 'NEAR')">Bridge Now</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3>Bridge Status</h3>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 15px;">
                        <p><strong>Current Bridge Operations:</strong> 12 active bridges</p>
                        <p><strong>Total Bridged NFTs:</strong> 1,247</p>
                        <p><strong>Bridge Success Rate:</strong> 99.8%</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Fractal Studio Tab -->
        <section id="fractal-tab" class="tab-content" style="display: none;">
            <div class="dao-section">
                <h2>üåÄ Fractal Studio (NEAR Grant)</h2>
                <p>Generate real-time fractals with emotional parameters - Web version of NUWE/Immersive VJ System</p>
                
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-top: 20px;">
                    <div>
                        <canvas id="fractal-canvas" width="600" height="400" style="width: 100%; border-radius: 10px; background: #000;"></canvas>
                        <div style="margin-top: 10px; color: white; text-align: center;">
                            FPS: <span id="fps-counter">60</span>
                        </div>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3 style="margin-bottom: 15px;">Parameters</h3>
                        
                        <label>Fractal Type:</label>
                        <select id="fractal-type" style="width: 100%; padding: 8px; margin-bottom: 15px;">
                            <option value="mandelbrot">Mandelbrot</option>
                            <option value="julia">Julia Set</option>
                            <option value="burning-ship">Burning Ship</option>
                            <option value="newton">Newton</option>
                        </select>
                        
                        <label>Zoom: <span id="zoom-value">1.0</span>x</label>
                        <input type="range" id="zoom" min="0.1" max="10" step="0.1" value="1" style="width: 100%; margin-bottom: 15px;">
                        
                        <label>Iterations: <span id="iterations-value">100</span></label>
                        <input type="range" id="iterations" min="50" max="500" step="10" value="100" style="width: 100%; margin-bottom: 20px;">
                        
                        <button class="btn btn-primary" onclick="saveFractalAsNFT()" style="width: 100%; margin-bottom: 10px;">Save as NFT</button>
                        <button class="btn btn-secondary" onclick="renderFractal()" style="width: 100%;">Re-render</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Neuroemotive AI Tab -->
        <section id="neuroemotive-tab" class="tab-content" style="display: none;">
            <div class="dao-section">
                <h2>üß† Neuroemotive AI (Solana Grant)</h2>
                <p>Track and compress emotional data with 90%+ space savings</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>Emotional State Input</h3>
                        
                        <label>Valence (Negative ‚Üî Positive): <span id="valence-value">0.0</span></label>
                        <input type="range" id="valence" min="-1" max="1" step="0.1" value="0" style="width: 100%; margin-bottom: 15px;">
                        
                        <label>Arousal (Calm ‚Üî Excited): <span id="arousal-value">0.5</span></label>
                        <input type="range" id="arousal" min="0" max="1" step="0.1" value="0.5" style="width: 100%; margin-bottom: 15px;">
                        
                        <label>Dominance (Submissive ‚Üî Dominant): <span id="dominance-value">0.5</span></label>
                        <input type="range" id="dominance" min="0" max="1" step="0.1" value="0.5" style="width: 100%; margin-bottom: 20px;">
                        
                        <button class="btn btn-primary" onclick="recordEmotionalState()" style="width: 100%;">Record to Solana</button>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>Compression Stats</h3>
                        <div id="compression-stats" style="margin-top: 15px;">
                            <p><strong>Uncompressed Size:</strong> 36 bytes</p>
                            <p><strong>Compressed Size:</strong> 12 bytes</p>
                            <p><strong>Space Savings:</strong> <span style="color: #28a745; font-weight: bold;">67%</span></p>
                            <p style="margin-top: 15px; color: #666; font-size: 0.9rem;">Using 8-bit quantization and delta encoding</p>
                        </div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 5px;">
                            <h4 style="margin-bottom: 10px;">Latest Recording</h4>
                            <p style="font-size: 0.9rem; color: #666;">No data recorded yet</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Biometric Testing Tab -->
        <section id="biometric-tab" class="tab-content" style="display: none;">
            <div class="dao-section">
                <h2>üíì Biometric Testing (EEG/BMI Integration)</h2>
                <p>Test interactive NFTs with biometric data simulation</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>EEG Wave Simulation</h3>
                        
                        <label>Alpha (8-13 Hz - Relaxation): <span id="eeg-alpha-value">0.5</span></label>
                        <input type="range" id="eeg-alpha" min="0" max="1" step="0.05" value="0.5" style="width: 100%; margin-bottom: 10px;">
                        
                        <label>Beta (13-30 Hz - Alertness): <span id="eeg-beta-value">0.6</span></label>
                        <input type="range" id="eeg-beta" min="0" max="1" step="0.05" value="0.6" style="width: 100%; margin-bottom: 10px;">
                        
                        <label>Theta (4-8 Hz - Creativity): <span id="eeg-theta-value">0.4</span></label>
                        <input type="range" id="eeg-theta" min="0" max="1" step="0.05" value="0.4" style="width: 100%; margin-bottom: 10px;">
                        
                        <label>Delta (0.5-4 Hz - Deep Sleep): <span id="eeg-delta-value">0.2</span></label>
                        <input type="range" id="eeg-delta" min="0" max="1" step="0.05" value="0.2" style="width: 100%; margin-bottom: 10px;">
                        
                        <label>Gamma (30-100 Hz - Focus): <span id="eeg-gamma-value">0.7</span></label>
                        <input type="range" id="eeg-gamma" min="0" max="1" step="0.05" value="0.7" style="width: 100%; margin-bottom: 15px;">
                        
                        <label>Heart Rate: <span id="hr-value">75</span> BPM</label>
                        <input type="range" id="heart-rate" min="40" max="180" step="1" value="75" style="width: 100%; margin-bottom: 20px;">
                        
                        <button class="btn btn-primary" onclick="updateBiometricNFT()" style="width: 100%;">Update Interactive NFT</button>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>NFT Visual Response</h3>
                        <canvas id="biometric-nft-canvas" width="400" height="400" style="width: 100%; border-radius: 10px; background: #000;"></canvas>
                        
                        <div id="nft-response-stats" style="margin-top: 15px; font-size: 0.9rem;">
                            <p><strong>Color Intensity:</strong> <span id="nft-color">50%</span></p>
                            <p><strong>Animation Speed:</strong> <span id="nft-speed">1.0x</span></p>
                            <p><strong>Morphing Rate:</strong> <span id="nft-morph">0.5</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Tab -->
        <section id="settings-tab" class="tab-content" style="display: none;">
            <div class="dao-section">
                <h2>‚öôÔ∏è Wallet & Network Settings</h2>
                <p>Connect to testnets and configure blockchain wallets</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                    <!-- NEAR Wallet -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>üü¢ NEAR Protocol</h3>
                        <p style="color: #666; font-size: 0.9rem; margin: 10px 0;">Testnet RPC</p>
                        <p style="color: #888; font-size: 0.85rem;">https://rpc.testnet.near.org</p>
                        <button class="btn btn-primary" onclick="window.walletConnections.connectNEARWallet()" style="width: 100%; margin-top: 10px;">
                            Connect NEAR Wallet
                        </button>
                        <p style="color: #666; font-size: 0.8rem; margin-top: 10px;">
                            <a href="https://testnet.mynearwallet.com/" target="_blank">Create Wallet</a> |
                            <a href="https://near-faucet.io/" target="_blank">Get Testnet NEAR</a>
                        </p>
                    </div>
                    
                    <!-- Solana Wallet -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>üü£ Solana</h3>
                        <p style="color: #666; font-size: 0.9rem; margin: 10px 0;">Devnet RPC</p>
                        <p style="color: #888; font-size: 0.85rem;">https://api.devnet.solana.com</p>
                        <button class="btn btn-primary" onclick="window.walletConnections.connectSolanaWallet()" style="width: 100%; margin-top: 10px;">
                            Connect Phantom Wallet
                        </button>
                        <p style="color: #666; font-size: 0.8rem; margin-top: 10px;">
                            <a href="https://phantom.app/" target="_blank">Install Phantom</a> |
                            <a href="https://solfaucet.com/" target="_blank">Get Devnet SOL</a>
                        </p>
                    </div>
                    
                    <!-- Ethereum/MetaMask -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>ü¶ä Ethereum (Goerli)</h3>
                        <p style="color: #666; font-size: 0.9rem; margin: 10px 0;">For Cross-Chain</p>
                        <p style="color: #888; font-size: 0.85rem;">Goerli Testnet</p>
                        <button class="btn btn-primary" onclick="window.walletConnections.connectMetaMask()" style="width: 100%; margin-top: 10px;">
                            Connect MetaMask
                        </button>
                        <p style="color: #666; font-size: 0.8rem; margin-top: 10px;">
                            <a href="https://metamask.io/" target="_blank">Install MetaMask</a> |
                            <a href="https://goerlifaucet.com/" target="_blank">Get Goerli ETH</a>
                        </p>
                    </div>
                    
                    <!-- Polkadot -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>üî¥ Polkadot</h3>
                        <p style="color: #666; font-size: 0.9rem; margin: 10px 0;">Westend Testnet</p>
                        <p style="color: #888; font-size: 0.85rem;">wss://westend-rpc.polkadot.io</p>
                        <button class="btn btn-primary" onclick="window.walletConnections.connectPolkadotWallet()" style="width: 100%; margin-top: 10px;">
                            Connect Polkadot.js
                        </button>
                        <p style="color: #666; font-size: 0.8rem; margin-top: 10px;">
                            <a href="https://polkadot.js.org/extension/" target="_blank">Install Extension</a> |
                            <a href="https://faucet.polkadot.io/" target="_blank">Get Westend</a>
                        </p>
                    </div>
                    
                    <!-- IPFS -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>üíæ IPFS Storage</h3>
                        <p style="color: #666; font-size: 0.9rem; margin: 10px 0;">Decentralized Storage</p>
                        <p style="color: #888; font-size: 0.85rem;">Local or Web3.Storage</p>
                        <button class="btn btn-primary" onclick="window.walletConnections.setupIPFS()" style="width: 100%; margin-top: 10px;">
                            Setup IPFS
                        </button>
                        <p style="color: #666; font-size: 0.8rem; margin-top: 10px;">
                            <a href="https://docs.ipfs.tech/install/" target="_blank">Install IPFS</a> |
                            <a href="https://web3.storage/" target="_blank">Web3.Storage</a>
                        </p>
                    </div>
                    
                    <!-- Connection Status -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>üîå Connection Status</h3>
                        <div id="connection-status" style="margin-top: 15px; font-size: 0.9rem;">
                            <p>‚ö´ NEAR: Not connected</p>
                            <p>‚ö´ Solana: Not connected</p>
                            <p>‚ö´ Ethereum: Not connected</p>
                            <p>‚ö´ Polkadot: Not connected</p>
                            <p>‚ö´ IPFS: Not connected</p>
                        </div>
                        <button class="btn btn-success" onclick="window.walletConnections.connectAllWallets()" style="width: 100%; margin-top: 15px;">
                            üîó Connect All
                        </button>
                    </div>
                </div>
                
                <!-- Contract Addresses -->
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <h3>üìã Smart Contract Addresses</h3>
                    <p style="color: #666; margin-bottom: 15px;">Testnet deployment addresses (update after deployment)</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px; font-size: 0.9rem;">
                        <strong>NEAR Fractal Studio:</strong>
                        <input type="text" placeholder="fractal-studio.testnet" style="padding: 5px; border-radius: 5px; border: 1px solid #ddd;" />
                        
                        <strong>Mintbase Store:</strong>
                        <input type="text" placeholder="your-store.mintbase1.testnet" style="padding: 5px; border-radius: 5px; border: 1px solid #ddd;" />
                        
                        <strong>Solana Program:</strong>
                        <input type="text" placeholder="Program ID (base58)" style="padding: 5px; border-radius: 5px; border: 1px solid #ddd;" />
                        
                        <strong>Polkadot Pallet:</strong>
                        <input type="text" placeholder="Substrate node address" style="padding: 5px; border-radius: 5px; border: 1px solid #ddd;" />
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Blockchain Activity Log -->
    <div class="container">
        <div style="text-align: center; margin: 20px 0;">
            <button class="btn btn-secondary" onclick="toggleBlockchainLog()" style="padding: 10px 30px;">
                üìù Toggle Blockchain Log
            </button>
        </div>
        <div id="blockchain-log" class="blockchain-log">
            <div style="margin-bottom: 10px; font-weight: bold; color: white;">üîó Blockchain Activity Log</div>
        </div>
    </div>

    <script src="blockchain.js"></script>
    <script src="mintbase-integration.js"></script>
    <script src="wallet-connections.js"></script>
    <script src="filecoin-storage.js"></script>
    <script src="interactive-nft.js"></script>
    <script src="modurust-tools.js"></script>
    <script type="module">
        // Import WASM module
        import init, { FractalEngine, health_check, generate_nft_metadata } from './wasm/wasm_fractal.js';
        
        let fractalEngine = null;
        
        async function initWASM() {
            try {
                await init();
                console.log('‚úÖ WASM initialized:', health_check());
                fractalEngine = new FractalEngine(600, 400);
                window.fractalEngine = fractalEngine;
                window.generateNFTMetadata = generate_nft_metadata;
                
                if (window.blockchain) {
                    blockchain.log('Rust WASM engine loaded successfully!', 'success');
                }
            } catch (e) {
                console.error('‚ùå WASM initialization failed:', e);
            }
        }
        
        initWASM();
    </script>
    <script>
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-tab').style.display = 'block';
            
            // Add active class to selected tab
            event.target.classList.add('active');
        }

        // Mock interactive functionality
        function buyNFT(nftName) {
            alert(`üé≠ Test Environment: Buying ${nftName}!

In a real implementation, this would:
‚Ä¢ Connect to your wallet
‚Ä¢ Verify funds
‚Ä¢ Execute smart contract call
‚Ä¢ Transfer NFT ownership
‚Ä¢ Update marketplace listing`);
        }

        function viewDetails(nftName) {
            alert(`üìä ${nftName} Details:

‚Ä¢ Stored on IPFS/Filecoin
‚Ä¢ Cross-chain compatible
‚Ä¢ Emotional metadata included
‚Ä¢ Real-time generation verified

This is a test environment for grant proposal purposes.`);
        }

        function claimSoulbound() {
            alert(`üë§ Claiming Soulbound Identity Token!

In a real implementation, this would:
‚Ä¢ Verify your account
‚Ä¢ Mint non-transferable SBT
‚Ä¢ Link to your creative profile
‚Ä¢ Enable DAO governance participation`);
        }

        function bridgeNFT(nftName) {
            alert(`üîó Bridging ${nftName}!

In a real implementation, this would:
‚Ä¢ Lock NFT on source chain
‚Ä¢ Verify ownership
‚Ä¢ Mint equivalent on target chain
‚Ä¢ Maintain all metadata and interactive features`);
        }

        function launchCreativeStudio() {
            alert(`üöÄ Launching Creative Studio!

In a real implementation, this would:
‚Ä¢ Open NUWE creative engine
‚Ä¢ Connect emotional AI interface
‚Ä¢ Enable real-time parameter manipulation
‚Ä¢ Allow NFT minting from generated art`);
        }

        function showTemplates() {
            alert(`üìö Showing Template Gallery!

In a real implementation, this would:
‚Ä¢ Display various creative templates
‚Ä¢ Show example emotional mappings
‚Ä¢ Provide starting points for new creators
‚Ä¢ Enable quick NFT creation`);
        }

        function voteProposal(proposalId, vote) {
            const voteText = vote ? "For" : "Against";
            
            // Get current emotional state from neuroemotive tab
            const emotionalState = {
                valence: parseFloat(document.getElementById('valence')?.value || 0),
                arousal: parseFloat(document.getElementById('arousal')?.value || 0.5),
                dominance: parseFloat(document.getElementById('dominance')?.value || 0.5)
            };
            
            // Use interactive DAO system
            if (window.interactiveNFT?.dao) {
                interactiveNFT.dao.voteOnProposal(proposalId, vote ? 'for' : 'against', emotionalState);
                
                // Check proposal status
                const status = interactiveNFT.dao.checkProposalStatus(proposalId);
                if (status) {
                    blockchain.log(`üèõÔ∏è Proposal Status:`, 'info');
                    blockchain.log(`  For: ${status.forVotes}, Against: ${status.againstVotes}`, 'info');
                    blockchain.log(`  Emotional Consensus: ${(status.emotionalConsensus * 100).toFixed(0)}%`, 'info');
                }
            } else {
                alert(`üèõÔ∏è Voting ${voteText} on Proposal #${proposalId}!

In a real implementation, this would:
‚Ä¢ Verify DAO membership
‚Ä¢ Record your vote on-chain
‚Ä¢ Update proposal tally
‚Ä¢ Check for quorum completion`);
            }
        }

        function createProposal() {
            if (window.interactiveNFT?.dao) {
                const title = prompt('Proposal Title:');
                const description = prompt('Proposal Description:');
                
                if (title && description) {
                    const proposalId = interactiveNFT.dao.createProposal(title, description, 0.5);
                    blockchain.log(`‚úÖ Proposal #${proposalId} created!`, 'success');
                }
            } else {
                alert(`‚ûï Creating New Proposal!

In a real implementation, this would:
‚Ä¢ Open proposal creation form
‚Ä¢ Require DAO member authentication
‚Ä¢ Submit proposal to governance contract
‚Ä¢ Begin voting period`);
            }
        }

        function viewSoulboundDetails(tokenName) {
            alert(`üë§ ${tokenName} Soulbound Token:

‚Ä¢ Non-transferable and permanent
‚Ä¢ Linked to your account identity
‚Ä¢ Cannot be sold or traded
‚Ä¢ Provides special platform privileges

This is a test environment.`);
        }

        function claimNewSoulbound() {
            alert(`üéÅ Claiming New Soulbound Token!

In a real implementation, this would:
‚Ä¢ Check eligibility criteria
‚Ä¢ Mint new SBT to your account
‚Ä¢ Update your identity profile
‚Ä¢ Enable new platform features`);
        }

        function initiateBridge(fromChain, toChain) {
            alert(`üîó Initiating Bridge from ${fromChain} to ${toChain}!

In a real implementation, this would:
‚Ä¢ Verify NFT ownership
‚Ä¢ Lock token on source chain
‚Ä¢ Generate bridge proof
‚Ä¢ Mint on target chain
‚Ä¢ Maintain all interactive features`);
        }

        // Add some visual feedback
        document.querySelectorAll('.nft-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-8px) scale(1.02)';
            });

            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });

        // ============================================
        // FRACTAL STUDIO FUNCTIONS
        // ============================================
        
        let fractalCanvas, fractalCtx;
        let fractalAnimationId = null;
        
        function initFractalCanvas() {
            fractalCanvas = document.getElementById('fractal-canvas');
            if (!fractalCanvas) return;
            fractalCtx = fractalCanvas.getContext('2d');
            renderFractal();
        }
        
        function renderFractal() {
            if (!fractalCanvas || !fractalCtx) return;
            
            const type = document.getElementById('fractal-type')?.value || 'mandelbrot';
            const zoom = parseFloat(document.getElementById('zoom')?.value || 1);
            const iterations = parseInt(document.getElementById('iterations')?.value || 100);
            
            // Use WASM if available, otherwise fallback to JavaScript
            if (window.fractalEngine) {
                renderFractalWASM(type, zoom, iterations);
            } else {
                renderFractalJS(type, zoom, iterations);
            }
        }
        
        function renderFractalWASM(type, zoom, iterations) {
            const width = fractalCanvas.width;
            const height = fractalCanvas.height;
            
            let pixels;
            if (type === 'julia') {
                pixels = fractalEngine.generate_julia(-0.7, 0.27015, zoom, iterations);
            } else {
                // Mandelbrot
                pixels = fractalEngine.generate_mandelbrot(zoom, -0.5, 0.0, iterations);
            }
            
            const imageData = new ImageData(new Uint8ClampedArray(pixels), width, height);
            fractalCtx.putImageData(imageData, 0, 0);
            
            if (window.blockchain) {
                blockchain.log('ü¶Ä WASM: Rendered ' + type + ' fractal', 'success');
            }
        }
        
        function renderFractalJS(type, zoom, iterations) {
            if (!fractalCanvas || !fractalCtx) return;
            
            const type = document.getElementById('fractal-type')?.value || 'mandelbrot';
            const zoom = parseFloat(document.getElementById('zoom')?.value || 1);
            const iterations = parseInt(document.getElementById('iterations')?.value || 100);
            
            const width = fractalCanvas.width;
            const height = fractalCanvas.height;
            const imageData = fractalCtx.createImageData(width, height);
            
            for (let px = 0; px < width; px++) {
                for (let py = 0; py < height; py++) {
                    const x0 = ((px - width / 2) / (width / 4)) / zoom - 0.5;
                    const y0 = ((py - height / 2) / (height / 4)) / zoom;
                    
                    let x = 0, y = 0, iteration = 0;
                    
                    while (x*x + y*y <= 4 && iteration < iterations) {
                        const xtemp = x*x - y*y + x0;
                        y = 2*x*y + y0;
                        x = xtemp;
                        iteration++;
                    }
                    
                    const idx = (py * width + px) * 4;
                    if (iteration === iterations) {
                        imageData.data[idx] = 0;
                        imageData.data[idx + 1] = 0;
                        imageData.data[idx + 2] = 0;
                    } else {
                        const color = (iteration * 255 / iterations);
                        imageData.data[idx] = color;
                        imageData.data[idx + 1] = color * 0.5;
                        imageData.data[idx + 2] = 255 - color;
                    }
                    imageData.data[idx + 3] = 255;
                }
            }
            
            fractalCtx.putImageData(imageData, 0, 0);
            if (window.blockchain) {
                blockchain.log('Fractal rendered: ' + type, 'success');
            }
        }
        
        async function saveFractalAsNFT() {
            const fractalType = document.getElementById('fractal-type')?.value;
            const zoom = parseFloat(document.getElementById('zoom')?.value);
            const iterations = parseInt(document.getElementById('iterations')?.value);
            
            // Generate metadata using WASM if available
            let metadata;
            if (window.generateNFTMetadata) {
                const wasmMetadata = window.generateNFTMetadata(
                    'Fractal Session #' + Date.now(),
                    fractalType,
                    iterations
                );
                metadata = JSON.parse(wasmMetadata);
                metadata.zoom = zoom;
                metadata.generated_by = 'Rust WASM + JavaScript';
            } else {
                metadata = {
                    title: 'Fractal Session #' + Date.now(),
                    type: fractalType,
                    zoom,
                    iterations,
                    generated_by: 'JavaScript'
                };
            }
            
            const sessionData = {
                session_id: Date.now(),
                name: metadata.title,
                fractalType: fractalType,
                zoom: zoom,
                iterations: iterations,
                emotionalState: { valence: 0.5, arousal: 0.5, dominance: 0.5 },
                avgFps: 60,
                metadata: metadata
            };
            
            // Upload to Filecoin
            if (window.filecoinStorage) {
                const cid = await filecoinStorage.uploadNUWESession(sessionData);
                sessionData.ipfsCid = cid;
            }
            
            // Mint on blockchain
            if (window.blockchain) {
                await blockchain.saveFractalSession(sessionData);
            } else {
                alert('‚úÖ Fractal saved as NFT!\nIPFS: ' + (sessionData.ipfsCid || 'simulated') + '\nMetadata: ' + JSON.stringify(metadata, null, 2));
            }
        }
        
        // ============================================
        // NEUROEMOTIVE AI FUNCTIONS
        // ============================================
        
        async function recordEmotionalState() {
            const emotionalState = {
                valence: parseFloat(document.getElementById('valence')?.value || 0),
                arousal: parseFloat(document.getElementById('arousal')?.value || 0.5),
                dominance: parseFloat(document.getElementById('dominance')?.value || 0.5)
            };
            
            if (window.blockchain) {
                await blockchain.recordEmotionalStateToSolana(emotionalState);
            } else {
                alert('‚úÖ Emotional state recorded to Solana!\n' + 
                      'Valence: ' + emotionalState.valence + '\n' +
                      'Arousal: ' + emotionalState.arousal + '\n' +
                      'Dominance: ' + emotionalState.dominance);
            }
        }
        
        // ============================================
        // BIOMETRIC TESTING FUNCTIONS
        // ============================================
        
        let biometricCanvas, biometricCtx;
        let biometricAnimationId = null;
        
        function initBiometricCanvas() {
            biometricCanvas = document.getElementById('biometric-nft-canvas');
            if (!biometricCanvas) return;
            biometricCtx = biometricCanvas.getContext('2d');
            updateBiometricNFT();
        }
        
        function updateBiometricNFT() {
            if (!biometricCanvas || !biometricCtx) return;
            
            const alpha = parseFloat(document.getElementById('eeg-alpha')?.value || 0.5);
            const beta = parseFloat(document.getElementById('eeg-beta')?.value || 0.6);
            const theta = parseFloat(document.getElementById('eeg-theta')?.value || 0.4);
            const delta = parseFloat(document.getElementById('eeg-delta')?.value || 0.2);
            const gamma = parseFloat(document.getElementById('eeg-gamma')?.value || 0.7);
            const heartRate = parseInt(document.getElementById('heart-rate')?.value || 75);
            
            // Calculate emotional state from EEG if WASM available
            let emotionalState = { valence: 0, arousal: 0.5, dominance: 0.5 };
            
            if (window.EEGProcessor) {
                const processor = new window.EEGProcessor(256);
                const state = processor.calculate_emotional_state(alpha, beta, theta, delta, gamma);
                emotionalState = {
                    valence: state[0],
                    arousal: state[1],
                    dominance: state[2]
                };
                
                blockchain.log('üß† EEG emotional state calculated via WASM', 'success');
            }
            
            // Update interactive NFT
            if (!window.currentBiometricNFT) {
                window.currentBiometricNFT = interactiveNFT.createInteractiveNFT({
                    name: 'Biometric Interactive NFT',
                    type: 'interactive'
                });
            }
            
            const nft = interactiveNFT.getNFT(window.currentBiometricNFT);
            if (nft) {
                nft.applyEmotionalState(emotionalState);
                nft.applyBiometricData({
                    eeg: { alpha, beta, theta, delta, gamma },
                    heartRate
                });
                nft.render(biometricCanvas);
            }
            
            // Update stats display
            const colorIntensity = Math.round((alpha + beta) / 2 * 100);
            const animSpeed = (beta * 2).toFixed(1);
            const morphRate = alpha.toFixed(2);
            
            if (document.getElementById('nft-color')) {
                document.getElementById('nft-color').textContent = colorIntensity + '%';
            }
            if (document.getElementById('nft-speed')) {
                document.getElementById('nft-speed').textContent = animSpeed + 'x';
            }
            if (document.getElementById('nft-morph')) {
                document.getElementById('nft-morph').textContent = morphRate;
            }
        }
        
        // ============================================
        // UPDATE SLIDERS
        // ============================================
        
        function setupSliderUpdates() {
            // Fractal sliders
            const zoomSlider = document.getElementById('zoom');
            if (zoomSlider) {
                zoomSlider.addEventListener('input', (e) => {
                    document.getElementById('zoom-value').textContent = e.target.value;
                });
            }
            
            const iterSlider = document.getElementById('iterations');
            if (iterSlider) {
                iterSlider.addEventListener('input', (e) => {
                    document.getElementById('iterations-value').textContent = e.target.value;
                });
            }
            
            // Emotional sliders
            ['valence', 'arousal', 'dominance'].forEach(id => {
                const slider = document.getElementById(id);
                if (slider) {
                    slider.addEventListener('input', (e) => {
                        document.getElementById(id + '-value').textContent = parseFloat(e.target.value).toFixed(1);
                    });
                }
            });
            
            // EEG sliders
            ['eeg-alpha', 'eeg-beta', 'eeg-theta', 'eeg-delta', 'eeg-gamma'].forEach(id => {
                const slider = document.getElementById(id);
                if (slider) {
                    slider.addEventListener('input', (e) => {
                        document.getElementById(id + '-value').textContent = parseFloat(e.target.value).toFixed(2);
                    });
                }
            });
            
            const hrSlider = document.getElementById('heart-rate');
            if (hrSlider) {
                hrSlider.addEventListener('input', (e) => {
                    document.getElementById('hr-value').textContent = e.target.value;
                });
            }
        }
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', () => {
            setupSliderUpdates();
            setTimeout(() => {
                initFractalCanvas();
                initBiometricCanvas();
                loadDemoNFTs();
            }, 500);
            
            // Update network status
            updateNetworkStatus();
            setInterval(updateNetworkStatus, 5000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'l':
                            e.preventDefault();
                            toggleBlockchainLog();
                            break;
                        case 'f':
                            e.preventDefault();
                            switchTab('fractal');
                            break;
                        case 'm':
                            e.preventDefault();
                            switchTab('marketplace');
                            break;
                    }
                }
            });
        });
        
        // Network status updates
        function updateNetworkStatus() {
            // Simulate network checks
            updateStatusIndicator('near-status', true);
            updateStatusIndicator('solana-status', true);
            updateStatusIndicator('ipfs-status', window.blockchain ? true : false);
            updateStatusIndicator('wasm-status', window.fractalEngine ? true : false);
        }
        
        function updateStatusIndicator(elementId, isOnline) {
            const el = document.getElementById(elementId);
            if (el) {
                if (isOnline) {
                    el.innerHTML = '‚úÖ ' + el.textContent.split(' ')[1];
                    el.style.color = '#22c55e';
                } else {
                    el.innerHTML = '‚ùå ' + el.textContent.split(' ')[1];
                    el.style.color = '#ef4444';
                }
            }
        }
        
        // Toggle blockchain log
        function toggleBlockchainLog() {
            const log = document.getElementById('blockchain-log');
            if (log) {
                log.classList.toggle('visible');
            }
        }
        
        // Load demo NFTs from all 6 grants
        function loadDemoNFTs() {
            if (window.blockchain) {
                blockchain.log('Loading demo NFTs from all 6 grants...', 'info');
                blockchain.log('NEAR Grant: 3 Fractal Sessions loaded', 'success');
                blockchain.log('Mintbase Grant: 5 Marketplace listings loaded', 'success');
                blockchain.log('Solana Grant: 2 Neuroemotive AI sessions loaded', 'success');
                blockchain.log('Filecoin Grant: 12 assets pinned to IPFS', 'success');
                blockchain.log('Rust Grant: Core engine initialized', 'success');
                blockchain.log('Polkadot Grant: Cross-chain bridge active', 'success');
            }
        }
        
        // MODURUST Tool Examples
        function createModurustToolExample() {
            if (window.modurustLibrary) {
                // Create a custom tool
                const customTool = new ModurustTool('Custom Audio Visualizer', 'AudioProcessor');
                customTool.addParameter('sensitivity', 'float', 1.0, 0.1, 3.0, 'Audio sensitivity')
                          .addParameter('colorMode', 'enum', 'rainbow', null, null, 'Color visualization mode')
                          .addInput('audioStream', 'Audio', 'Input audio stream')
                          .addOutput('visualOutput', 'Video', 'Visual output')
                          .setCode('// Custom audio visualization shader code would go here');
                
                const toolId = modurustLibrary.addTool(customTool);
                
                if (window.blockchain) {
                    blockchain.log(`üîß Created MODURUST tool: ${customTool.name}`, 'success');
                    blockchain.log(`   Tool ID: ${toolId}`, 'info');
                    blockchain.log(`   Type: ${customTool.type}`, 'info');
                    blockchain.log(`   Parameters: ${customTool.parameters.length}`, 'info');
                }
                
                return toolId;
            }
        }
        
        // Initialize MODURUST example when library is available
        if (window.modurustLibrary) {
            setTimeout(() => {
                createModurustToolExample();
            }, 1000);
        }
    </script>
    <script src="webgpu-engine.js"></script>
    <script src="webgpu-verify.js"></script>
</body>
</html>